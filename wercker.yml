box: emarginatus/render_website
build:
  steps:
    - script:
        code: |
          Rscript -e "blogdown::build_site()"
          Rscript -e "devtools::install_github('thierryo/rhinolophus@multi_contour')"
          Rscript -e "devtools::install_github('inbo/inbotheme')"
          Rscript -e "devtools::install_github('tidyverse/ggplot2')"
          Rscript -e "install.packages(c('plotly', 'wordcloud'))"
          cd source/rhinolophus
          Rscript -e "bookdown::render_book(input = 'index.Rmd')"
          mv kermit.html ../../public/post/kermit
          Rscript -e "bookdown::render_book(input = 'index.Rmd', output_format = 'bookdown::gitbook')"

deploy:
  steps:
    - script:
        code: |
          zip -r website.zip public
          curl -H "Content-Type: application/zip" \
               -H "Authorization: Bearer $NETLIFY_KEY" \
               --data-binary "@website.zip" \
               https://api.netlify.com/api/v1/sites/$NETLIFY_SITEID/deploys
